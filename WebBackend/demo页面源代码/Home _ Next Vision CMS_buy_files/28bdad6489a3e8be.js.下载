(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,345395,e=>{"use strict";var t,r,n,a,o,i,s,c=e.i(843476),l=e.i(271645),u=e.i(174080);(t=a||(a={})).INITIAL="initial",t.PENDING="pending",t.REJECTED="rejected",t.RESOLVED="resolved",(r=o||(o={})).LOADING_STATUS="setLoadingStatus",r.RESET_OPTIONS="resetOptions",r.SET_BRAINTREE_INSTANCE="braintreeInstance",(n=i||(i={})).NUMBER="number",n.CVV="cvv",n.EXPIRATION_DATE="expirationDate",n.EXPIRATION_MONTH="expirationMonth",n.EXPIRATION_YEAR="expirationYear",n.POSTAL_CODE="postalCode";var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function p(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function f(e,t,r){if(r||2==arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var m="data-react-paypal-script-id",h="react-paypal-js",v="dataNamespace",y="dataSdkIntegrationSource",b="paypal";function g(e){return void 0===e&&(e=b),window[e]}function E(e){var t=e.reactComponentName,r=e.sdkComponentKey,n=e.sdkRequestedComponents,a=void 0===n?"":n,o=e.sdkDataNamespace,i=r.charAt(0).toUpperCase().concat(r.substring(1)),s="Unable to render <".concat(t," /> because window.").concat(void 0===o?b:o,".").concat(i," is undefined."),c="string"==typeof a?a:a.join(",");if(!c.includes(r)){var l=[c,r].filter(Boolean).join();s+="\nTo fix the issue, add '".concat(r,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(l,"'}}>`.")}return s}function w(e){e[m];var t=p(e,[m+""]);return"react-paypal-js-".concat(function(e){for(var t="",r=0;r<e.length;r++){var n=e[r].charCodeAt(0)*r;e[r+1]&&(n+=e[r+1].charCodeAt(0)*(r-1)),t+=String.fromCharCode(97+Math.abs(n)%26)}return t}(JSON.stringify(t)))}function S(e,t){var r,n,i,s;switch(t.type){case o.LOADING_STATUS:if("object"==typeof t.value)return d(d({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message});return d(d({},e),{loadingStatus:t.value});case o.RESET_OPTIONS:return i=e.options[m],(null==(s=self.document.querySelector("script[".concat(m,'="').concat(i,'"]')))?void 0:s.parentNode)&&s.parentNode.removeChild(s),d(d({},e),{loadingStatus:a.PENDING,options:d(d(((r={})[y]=h,r),t.value),((n={})[m]="".concat(w(t.value)),n))});case o.SET_BRAINTREE_INSTANCE:return d(d({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var N=(0,l.createContext)(null);function j(){var e=function(e){if("function"==typeof(null==e?void 0:e.dispatch)&&0!==e.dispatch.length)return e;throw Error("usePayPalScriptReducer must be used within a PayPalScriptProvider")}((0,l.useContext)(N));return[d(d({},e),{isInitial:e.loadingStatus===a.INITIAL,isPending:e.loadingStatus===a.PENDING,isResolved:e.loadingStatus===a.RESOLVED,isRejected:e.loadingStatus===a.REJECTED}),e.dispatch]}(0,l.createContext)({});var P=function(e){var t,r,n=e.className,a=e.disabled,o=void 0!==a&&a,i=e.children,s=e.forceReRender,c=p(e,["className","disabled","children","forceReRender"]),u="".concat(void 0===n?"":n," ").concat(o?"paypal-buttons-disabled":"").trim(),m=(0,l.useRef)(null),h=(0,l.useRef)(null),y=((t=(0,l.useRef)(new Proxy({},{get:function(e,t,r){return"function"==typeof e[t]?function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e[t].apply(e,r)}:Reflect.get(e,t,r)}}))).current=Object.assign(t.current,c),t.current),b=j()[0],w=b.isResolved,S=b.options,N=(0,l.useState)(null),x=N[0],O=N[1],T=(0,l.useState)(!0),C=T[0],I=T[1],k=(0,l.useState)(null)[1];function R(){null!==h.current&&h.current.close().catch(function(){})}return(null==(r=h.current)?void 0:r.updateProps)&&h.current.updateProps({message:c.message}),(0,l.useEffect)(function(){if(!1===w)return R;var e=g(S.dataNamespace);if(void 0===e||void 0===e.Buttons)return k(function(){throw Error(E({reactComponentName:P.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:S.components,sdkDataNamespace:S[v]}))}),R;try{h.current=e.Buttons(d(d({},y),{onInit:function(e,t){O(t),"function"==typeof c.onInit&&c.onInit(e,t)}}))}catch(e){return k(function(){throw Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(e))})}return!1===h.current.isEligible()?I(!1):m.current&&h.current.render(m.current).catch(function(e){null!==m.current&&0!==m.current.children.length&&k(function(){throw Error("Failed to render <PayPalButtons /> component. ".concat(e))})}),R},f(f([w],void 0===s?[]:s,!0),[c.fundingSource],!1)),(0,l.useEffect)(function(){null!==x&&(!0===o?x.disable().catch(function(){}):x.enable().catch(function(){}))},[o,x]),l.default.createElement(l.default.Fragment,null,C?l.default.createElement("div",{ref:m,style:o?{opacity:.38}:{},className:u}):i)};function x(e,t){void 0===t&&(t={});var r=document.createElement("script");return r.src=e,Object.keys(t).forEach(function(e){r.setAttribute(e,t[e]),"data-csp-nonce"===e&&r.setAttribute("nonce",t["data-csp-nonce"])}),r}P.displayName="PayPalButtons","function"==typeof SuppressedError&&SuppressedError;function O(e,t){if("object"!=typeof e||null===e)throw Error("Expected an options object.");var r=e.environment;if(r&&"production"!==r&&"sandbox"!==r)throw Error('The `environment` option must be either "production" or "sandbox".');if(void 0!==t&&"function"!=typeof t)throw Error("Expected PromisePonyfill to be a function.")}var T=function(e){var t=e.className,r=e.children,n=p(e,["className","children"]),a=j()[0],o=a.isResolved,i=a.options,s=(0,l.useRef)(null),c=(0,l.useState)(!0),u=c[0],f=c[1],m=(0,l.useState)(null)[1],h=function(e){var t=s.current;if(!t||!e.isEligible())return f(!1);t.firstChild&&t.removeChild(t.firstChild),e.render(t).catch(function(e){null!==t&&0!==t.children.length&&m(function(){throw Error("Failed to render <PayPalMarks /> component. ".concat(e))})})};return(0,l.useEffect)(function(){if(!1!==o){var e=g(i[v]);if(void 0===e||void 0===e.Marks)return m(function(){throw Error(E({reactComponentName:T.displayName,sdkComponentKey:"marks",sdkRequestedComponents:i.components,sdkDataNamespace:i[v]}))});h(e.Marks(d({},n)))}},[o,n.fundingSource]),l.default.createElement(l.default.Fragment,null,u?l.default.createElement("div",{ref:s,className:void 0===t?"":t}):r)};T.displayName="PayPalMarks";var C=function(e){var t=e.className,r=e.forceReRender,n=p(e,["className","forceReRender"]),a=j()[0],o=a.isResolved,i=a.options,s=(0,l.useRef)(null),c=(0,l.useRef)(null),u=(0,l.useState)(null)[1];return(0,l.useEffect)(function(){if(!1!==o){var e=g(i[v]);if(void 0===e||void 0===e.Messages)return u(function(){throw Error(E({reactComponentName:C.displayName,sdkComponentKey:"messages",sdkRequestedComponents:i.components,sdkDataNamespace:i[v]}))});c.current=e.Messages(d({},n)),c.current.render(s.current).catch(function(e){null!==s.current&&0!==s.current.children.length&&u(function(){throw Error("Failed to render <PayPalMessages /> component. ".concat(e))})})}},f([o],void 0===r?[]:r,!0)),l.default.createElement("div",{ref:s,className:void 0===t?"":t})};C.displayName="PayPalMessages";var I=function(e){var t,r=e.options,n=void 0===r?{clientId:"test"}:r,i=e.children,s=e.deferLoading,c=void 0!==s&&s,u=(0,l.useReducer)(S,{options:d(d({},n),((t={}).dataJsSdkLibrary=h,t[y]=h,t[m]="".concat(w(n)),t)),loadingStatus:c?a.INITIAL:a.PENDING}),p=u[0],f=u[1];return(0,l.useEffect)(function(){if(!1===c&&p.loadingStatus===a.INITIAL)return f({type:o.LOADING_STATUS,value:a.PENDING});if(p.loadingStatus===a.PENDING){var e=!0;return(function(e,t){if(void 0===t&&(t=Promise),O(e,t),"undefined"==typeof document)return t.resolve(null);var r,n,a,o,i,s,c,l,u,d,p=(o=e.sdkBaseUrl,i=e.environment,s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}(e,["sdkBaseUrl","environment"]),c=o||("sandbox"===i?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"),u=(l=Object.keys(s).filter(function(e){return void 0!==s[e]&&null!==s[e]&&""!==s[e]}).reduce(function(e,t){var r=s[t].toString();return"data"===(t=t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,function(e,t){return(t?"-":"")+e.toLowerCase()})).substring(0,4)||"crossorigin"===t?e.attributes[t]=r:e.queryParams[t]=r,e},{queryParams:{},attributes:{}})).queryParams,d=l.attributes,u["merchant-id"]&&-1!==u["merchant-id"].indexOf(",")&&(d["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(c,"?").concat((n="",Object.keys(r=u).forEach(function(e){0!==n.length&&(n+="&"),n+=e+"="+r[e]}),n)),attributes:d}),f=p.url,m=p.attributes,h=m["data-namespace"]||"paypal",v=(a=h,window[a]);return(m["data-js-sdk-library"]||(m["data-js-sdk-library"]="paypal-js"),function(e,t){var r=document.querySelector('script[src="'.concat(e,'"]'));if(null===r)return null;var n=x(e,t),a=r.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(n.dataset).length)return null;var o=!0;return Object.keys(a.dataset).forEach(function(e){a.dataset[e]!==n.dataset[e]&&(o=!1)}),o?r:null}(f,m)&&v)?t.resolve(v):(function(e,t){void 0===t&&(t=Promise),O(e,t);var r=e.url,n=e.attributes;if("string"!=typeof r||0===r.length)throw Error("Invalid url.");if(void 0!==n&&"object"!=typeof n)throw Error("Expected attributes to be an object.");return new t(function(e,t){var a,o,i,s,c,l;if("undefined"==typeof document)return e();o=(a={url:r,attributes:n,onSuccess:function(){return e()},onError:function(){return t(Error('The script "'.concat(r,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.')))}}).url,i=a.attributes,s=a.onSuccess,c=a.onError,(l=x(o,i)).onerror=c,l.onload=s,document.head.insertBefore(l,document.head.firstElementChild)})})({url:f,attributes:m},t).then(function(){var e,t=(e=h,window[e]);if(t)return t;throw Error("The window.".concat(h," global variable is not available."))})})(p.options).then(function(){e&&f({type:o.LOADING_STATUS,value:a.RESOLVED})}).catch(function(t){console.error("".concat("Failed to load the PayPal JS SDK script."," ").concat(t)),e&&f({type:o.LOADING_STATUS,value:{state:a.REJECTED,message:String(t)}})}),function(){e=!1}}},[p.options,c,p.loadingStatus]),l.default.createElement(N.Provider,{value:d(d({},p),{dispatch:f})},i)};function k(){}(0,l.createContext)({cardFieldsForm:null,fields:{},registerField:k,unregisterField:k});var R="clover",A="https://js.stripe.com",D="".concat(A,"/").concat(R,"/stripe.js"),_=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,L=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,F=function(){for(var e=document.querySelectorAll('script[src^="'.concat(A,'"]')),t=0;t<e.length;t++){var r,n=e[t];if(r=n.src,_.test(r)||L.test(r))return n}return null},B=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(D).concat(t);var n=document.head||document.body;if(!n)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(r),r},M=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"8.1.0",startTime:t})},U=null,q=null,G=null,J=function(e,t,r){if(null===e)return null;var n,a=t[0].match(/^pk_test/),o=3===(n=e.version)?"v3":n;a&&o!==R&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.1.0"," expected Stripe.js@").concat(R,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var i=e.apply(void 0,t);return M(i,r),i},z=!1,K=function(){return s?s:s=(null!==U?U:(U=new Promise(function(e,t){if("undefined"==typeof window||"undefined"==typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var r,n=F();n?n&&null!==G&&null!==q&&(n.removeEventListener("load",G),n.removeEventListener("error",q),null==(r=n.parentNode)||r.removeChild(n),n=B(null)):n=B(null),G=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},q=function(e){t(Error("Failed to load Stripe.js",{cause:e}))},n.addEventListener("load",G),n.addEventListener("error",q)}catch(e){t(e);return}})).catch(function(e){return U=null,Promise.reject(e)})).catch(function(e){return s=null,Promise.reject(e)})};Promise.resolve().then(function(){return K()}).catch(function(e){z||console.warn(e)});var V=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];z=!0;var n=Date.now();return K().then(function(e){return J(e,t,n)})};function X({clientId:e,currency:t,stripePublishableKey:r,enabledProviders:n}){let[a,o]=(0,l.useState)(!1),[i,s]=(0,l.useState)(null),[d,p]=(0,l.useState)(!1),[f,m]=(0,l.useState)(!1),h=(0,l.useMemo)(()=>({clientId:e,currency:t}),[e,t]),v=(0,l.useMemo)(()=>V(r),[r]);(0,l.useEffect)(()=>{let e=e=>{let t=e.target;if(!t)return;let r=t.closest("[data-open-payment-modal]");if(!r)return;e.preventDefault();let n=Number(r.getAttribute("data-package-id"));n&&(s(n),o(!0))};return document.addEventListener("click",e,!0),()=>document.removeEventListener("click",e,!0)},[]);let y=async()=>{if(i&&v){p(!0);try{let e=await fetch("/api/payments/providers/stripe/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:i})}),{sessionUrl:t}=await e.json();if(!t)throw Error("No session URL received");window.location.href=t}catch(e){console.error("Stripe payment error:",e),alert("Payment failed. Please try again.")}finally{p(!1)}}},b=async()=>{if(i){m(!0);try{let e=await fetch("/api/payments/providers/oxapay/create-invoice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:i})}),{invoiceUrl:t}=await e.json();if(!t)throw Error("No invoice URL received");window.location.href=t}catch(e){console.error("OxaPay payment error:",e),alert("Payment failed. Please try again.")}finally{m(!1)}}};if(!a||!i)return null;let g=(0,c.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[(0,c.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-xs animate__animated animate__fadeIn animate__faster","aria-hidden":"true",onClick:()=>o(!1)}),(0,c.jsxs)("div",{className:"relative z-10 w-full max-w-md mx-4 rounded-md border border-white/5 bg-[#171717] text-white shadow-xl animate__animated animate__zoomIn",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"px-5 py-4 border-b border-white/5 flex items-center justify-between",children:[(0,c.jsx)("div",{className:"text-base font-semibold",children:"Choose a payment method"}),(0,c.jsx)("button",{onClick:()=>o(!1),className:"text-white/70 hover:text-white","aria-label":"Close",children:"âœ•"})]}),(0,c.jsxs)("div",{className:"px-5 py-4 space-y-4",children:[(0,c.jsx)("div",{className:"grid grid-cols-1 gap-3",children:n.map(e=>"paypal"===e.id?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm text-white/80 mb-2",children:e.name}),(0,c.jsx)(I,{options:h,children:(0,c.jsx)(P,{style:{layout:"horizontal",height:40},createOrder:async()=>{let e=await fetch("/api/payments/providers/paypal/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:i})}),t=await e.json();if(!t.orderID)throw Error("No orderID");return t.orderID},onApprove:async e=>{try{let t=await fetch("/api/payments/providers/paypal/capture",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderID:e.orderID})});(await t.json()).captured?alert("Thank you! Crystals credited."):alert("Payment not captured.")}catch(e){console.error(e),alert("Payment failed")}finally{o(!1)}},onCancel:()=>o(!1)})})]},e.id):"stripe"===e.id?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm text-white/80 mb-2",children:e.name}),(0,c.jsx)("button",{onClick:y,disabled:d,className:"w-full h-10 bg-[#635BFF] hover:bg-[#5A52E5] disabled:bg-[#635BFF]/50 text-white rounded-sm font-medium transition-colors flex items-center justify-center",children:d?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Processing..."]}):"Pay with Stripe"})]},e.id):"oxapay"===e.id?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm text-white/80 mb-2",children:e.name}),(0,c.jsx)("button",{onClick:b,disabled:f,className:"w-full h-10 bg-[#F7931A] hover:bg-[#E8821A] disabled:bg-[#F7931A]/50 text-white rounded-sm font-medium transition-colors flex items-center justify-center",children:f?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Processing..."]}):"Pay with Crypto"})]},e.id):null)}),(0,c.jsx)("div",{className:"text-xs text-white/60",children:"Your points will be credited to your account shortly after the payment is confirmed. The process is automatic but if you encounter an issue please contact us."})]})]})]});return(0,u.createPortal)(g,document.body)}e.s(["default",()=>X],345395)}]);